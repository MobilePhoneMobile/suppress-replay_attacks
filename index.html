<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Suppress Replay Attack Protocol</title>

<style>
body{
margin:0;
background:radial-gradient(circle at top,#0b1228,#020617);
font-family:Segoe UI, sans-serif;
color:white;
overflow:hidden;
}
h1{text-align:center;color:#38bdf8;margin:10px 0}
.scene{position:relative;width:100vw;height:90vh;perspective:1200px;}

.node{
position:absolute;width:150px;height:150px;border-radius:50%;
display:flex;flex-direction:column;justify-content:center;align-items:center;
font-weight:bold;box-shadow:0 0 40px rgba(0,255,255,.6);
animation:float 6s infinite ease-in-out;
}
.node small{font-size:11px;color:#e2e8f0}

#alice{left:5%;top:60%;background:linear-gradient(145deg,#3b82f6,#1e3a8a)}
#kdc{left:42%;top:5%;background:linear-gradient(145deg,#facc15,#a16207)}
#bob{right:5%;top:60%;background:linear-gradient(145deg,#22c55e,#14532d)}

@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-15px)}}

.packet{
position:absolute;
padding:12px 22px;
border-radius:30px;
background:linear-gradient(145deg,#38bdf8,#0ea5e9);
font-size:14px;
white-space:nowrap;
box-shadow:0 0 25px #38bdf8;
transform:translate(-50%,-50%) scale(1);
transition:opacity 0.5s;
}

.explain{
position:absolute;
font-size:13px;
background:rgba(15,23,42,.95);
padding:8px 12px;
border-radius:10px;
border:1px solid #38bdf8;
white-space:nowrap;
box-shadow:0 0 15px rgba(56,189,248,.6);
transition:opacity 0.5s;
}

.controls{
position:fixed;
top:15px;
right:20px;
z-index:1000
}
button{
padding:8px 14px;
margin-left:6px;
border:none;
border-radius:6px;
background:#0ea5e9;
color:white;
cursor:pointer
}
button:hover{background:#0284c7}

.info{
position:absolute;
bottom:10px;
left:50%;
transform:translateX(-50%);
background:#020617cc;
padding:10px 20px;
border-radius:10px;
border:1px solid #334155;
font-size:14px;
color:#e5e7eb;
text-align:center;
}
</style>
</head>

<body>

<h1>Suppress Replay Attack Protocol</h1>

<div class="controls">
<button onclick="sim.prev()">â—€ Prev</button>
<button onclick="sim.next()">Next â–¶</button>
<button onclick="sim.reset()">Restart ðŸ”„</button>
</div>

<div class="scene" id="scene">
<div id="alice" class="node">A (Alice)<br><small>Initiator</small></div>
<div id="kdc" class="node">KDC<br><small>Trusted Server</small></div>
<div id="bob" class="node">B (Bob)<br><small>Responder</small></div>

<div id="info" class="info">Press Next â–¶ to start</div>
</div>

<script>
class Simulator{
constructor(){
this.step=0;
this.busy=false;
this.info=document.getElementById("info");
this.scene=document.getElementById("scene");
this.currentPacket=null;
this.currentExplain=null;

this.steps=[
{info:"A and B want secure communication using KDC"},
{from:"alice",to:"bob",msg:"IDA || NA",exp:"Alice sends ID and nonce NA"},
{from:"bob",to:"kdc",msg:"IDB || NB || E(KB)[IDA, NA, TB]",exp:"Bob requests session with timestamp"},
{from:"kdc",to:"alice",msg:"E(KA)[IDB, NA, KS, TB] + Ticket + NB",exp:"KDC generates session key KS"},
{from:"alice",to:"bob",msg:"Ticket + E(KS)[NB]",exp:"Alice proves she knows KS"},
{info:"Secure session established"},
{info:"Future authentication without KDC"},
{from:"alice",to:"bob",msg:"Old Ticket + NA2",exp:"Alice starts new session"},
{from:"bob",to:"alice",msg:"NB2 + E(KS)[NA2]",exp:"Bob verifies ticket"},
{from:"alice",to:"bob",msg:"E(KS)[NB2]",exp:"Mutual authentication complete"},
{info:"Replay attacks prevented using nonces and timestamps"}
];
}

hidePrevious(){
if(this.currentPacket){
this.currentPacket.style.opacity=0;
this.currentExplain.style.opacity=0;
}
}

move(from,to,label,exp){

this.busy=true;

// Hide previous step
this.hidePrevious();

let p=document.createElement("div");
p.className="packet";
p.innerText=label;
this.scene.appendChild(p);

let e=document.createElement("div");
e.className="explain";
e.innerText=exp;
this.scene.appendChild(e);

this.currentPacket=p;
this.currentExplain=e;

let f=document.getElementById(from).getBoundingClientRect();
let t=document.getElementById(to).getBoundingClientRect();

let start=null,
duration=24000;   // 24 seconds

let anim=(time)=>{
if(!start) start=time;
let prog=Math.min((time-start)/duration,1);

let x=f.left+(t.left-f.left)*prog;
let y=f.top+(t.top-f.top)*prog;
let scale=1+0.2*Math.sin(prog*Math.PI);

p.style.left=x+f.width/2+"px";
p.style.top=y+f.height/2+"px";
p.style.transform=`translate(-50%,-50%) scale(${scale})`;

e.style.left=x+f.width/2+"px";
e.style.top=y-40+"px";

if(prog<1){
requestAnimationFrame(anim);
}else{
this.busy=false;
}
};

requestAnimationFrame(anim);
}

update(){
let s=this.steps[this.step];

if(s.info){
this.hidePrevious();
this.info.innerText=s.info;
return;
}

this.info.innerText=s.exp;
this.move(s.from,s.to,s.msg,s.exp);
}

next(){
if(!this.busy && this.step<this.steps.length-1){
this.step++;
this.update();
}
}

prev(){
if(!this.busy && this.step>0){
this.step--;
this.update();
}
}

reset(){
if(!this.busy){
this.step=0;
this.info.innerText="Press Next â–¶ to start";
document.querySelectorAll(".packet,.explain").forEach(el=>el.remove());
this.currentPacket=null;
this.currentExplain=null;
}
}
}

const sim=new Simulator();
sim.update();
</script>

</body>
</html>

                     
